{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar INS = {\n  GET_VERSION: 0x00\n};\nvar CHUNK_SIZE = 250;\nvar PAYLOAD_TYPE = {\n  INIT: 0x00,\n  ADD: 0x01,\n  LAST: 0x02\n};\nvar P1_VALUES = {\n  ONLY_RETRIEVE: 0x00,\n  SHOW_ADDRESS_IN_DEVICE: 0x01\n};\nvar SCHEME = {\n  ED25519: 0x00,\n  SR25519: 0x01\n};\nvar ERROR_CODE = {\n  NoError: 0x9000\n};\nvar ERROR_DESCRIPTION = {\n  1: \"U2F: Unknown\",\n  2: \"U2F: Bad request\",\n  3: \"U2F: Configuration unsupported\",\n  4: \"U2F: Device Ineligible\",\n  5: \"U2F: Timeout\",\n  14: \"Timeout\",\n  0x9000: \"No errors\",\n  0x9001: \"Device is busy\",\n  0x6802: \"Error deriving keys\",\n  0x6400: \"Execution Error\",\n  0x6700: \"Wrong Length\",\n  0x6982: \"Empty Buffer\",\n  0x6983: \"Output buffer too small\",\n  0x6984: \"Data is invalid\",\n  0x6985: \"Conditions not satisfied\",\n  0x6986: \"Transaction rejected\",\n  0x6a80: \"Bad key handle\",\n  0x6b00: \"Invalid P1/P2\",\n  0x6d00: \"Instruction not supported\",\n  0x6e00: \"App does not seem to be open\",\n  0x6f00: \"Unknown error\",\n  0x6f01: \"Sign/verify error\"\n};\n\nfunction errorCodeToString(statusCode) {\n  if (statusCode in ERROR_DESCRIPTION) return ERROR_DESCRIPTION[statusCode];\n  return \"Unknown Status Code: \".concat(statusCode);\n}\n\nfunction isDict(v) {\n  return (0, _typeof2.default)(v) === \"object\" && v !== null && !(v instanceof Array) && !(v instanceof Date);\n}\n\nfunction processErrorResponse(response) {\n  if (response) {\n    if (isDict(response)) {\n      if (Object.prototype.hasOwnProperty.call(response, \"statusCode\")) {\n        return {\n          return_code: response.statusCode,\n          error_message: errorCodeToString(response.statusCode)\n        };\n      }\n\n      if (Object.prototype.hasOwnProperty.call(response, \"return_code\") && Object.prototype.hasOwnProperty.call(response, \"error_message\")) {\n        return response;\n      }\n    }\n\n    return {\n      return_code: 0xffff,\n      error_message: response.toString()\n    };\n  }\n\n  return {\n    return_code: 0xffff,\n    error_message: response.toString()\n  };\n}\n\nfunction getVersion(_x, _x2) {\n  return _getVersion.apply(this, arguments);\n}\n\nfunction _getVersion() {\n  _getVersion = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(transport, cla) {\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", transport.send(cla, INS.GET_VERSION, 0, 0).then(function (response) {\n              var errorCodeData = response.slice(-2);\n              var returnCode = errorCodeData[0] * 256 + errorCodeData[1]; // 12 bytes + 2 error code\n\n              if (response.length !== 14) {\n                return {\n                  return_code: 0x6984,\n                  error_message: errorCodeToString(0x6984)\n                };\n              }\n\n              var major = response[1] * 256 + response[2];\n              var minor = response[3] * 256 + response[4];\n              var patch = response[5] * 256 + response[6];\n              var deviceLocked = response[7] === 1; // eslint-disable-next-line no-bitwise\n\n              var targetId = (response[8] << 24) + (response[9] << 16) + (response[10] << 8) + (response[11] << 0);\n              return {\n                return_code: returnCode,\n                error_message: errorCodeToString(returnCode),\n                // ///\n                test_mode: response[0] !== 0,\n                major: major,\n                minor: minor,\n                patch: patch,\n                deviceLocked: deviceLocked,\n                target_id: targetId.toString(16)\n              };\n            }, processErrorResponse));\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getVersion.apply(this, arguments);\n}\n\nmodule.exports = {\n  CHUNK_SIZE: CHUNK_SIZE,\n  INS: INS,\n  PAYLOAD_TYPE: PAYLOAD_TYPE,\n  P1_VALUES: P1_VALUES,\n  SCHEME: SCHEME,\n  ERROR_CODE: ERROR_CODE,\n  getVersion: getVersion,\n  processErrorResponse: processErrorResponse,\n  errorCodeToString: errorCodeToString\n};","map":{"version":3,"sources":["/Users/bmacer/substrate-node-template/substrate-front-end-template/node_modules/@zondax/ledger-polkadot/dist/common.js"],"names":["_interopRequireDefault","require","_regenerator","_asyncToGenerator2","_typeof2","INS","GET_VERSION","CHUNK_SIZE","PAYLOAD_TYPE","INIT","ADD","LAST","P1_VALUES","ONLY_RETRIEVE","SHOW_ADDRESS_IN_DEVICE","SCHEME","ED25519","SR25519","ERROR_CODE","NoError","ERROR_DESCRIPTION","errorCodeToString","statusCode","concat","isDict","v","default","Array","Date","processErrorResponse","response","Object","prototype","hasOwnProperty","call","return_code","error_message","toString","getVersion","_x","_x2","_getVersion","apply","arguments","mark","_callee","transport","cla","wrap","_callee$","_context","prev","next","abrupt","send","then","errorCodeData","slice","returnCode","length","major","minor","patch","deviceLocked","targetId","test_mode","target_id","stop","module","exports"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar INS = {\n  GET_VERSION: 0x00\n};\nvar CHUNK_SIZE = 250;\nvar PAYLOAD_TYPE = {\n  INIT: 0x00,\n  ADD: 0x01,\n  LAST: 0x02\n};\nvar P1_VALUES = {\n  ONLY_RETRIEVE: 0x00,\n  SHOW_ADDRESS_IN_DEVICE: 0x01\n};\nvar SCHEME = {\n  ED25519: 0x00,\n  SR25519: 0x01\n};\nvar ERROR_CODE = {\n  NoError: 0x9000\n};\nvar ERROR_DESCRIPTION = {\n  1: \"U2F: Unknown\",\n  2: \"U2F: Bad request\",\n  3: \"U2F: Configuration unsupported\",\n  4: \"U2F: Device Ineligible\",\n  5: \"U2F: Timeout\",\n  14: \"Timeout\",\n  0x9000: \"No errors\",\n  0x9001: \"Device is busy\",\n  0x6802: \"Error deriving keys\",\n  0x6400: \"Execution Error\",\n  0x6700: \"Wrong Length\",\n  0x6982: \"Empty Buffer\",\n  0x6983: \"Output buffer too small\",\n  0x6984: \"Data is invalid\",\n  0x6985: \"Conditions not satisfied\",\n  0x6986: \"Transaction rejected\",\n  0x6a80: \"Bad key handle\",\n  0x6b00: \"Invalid P1/P2\",\n  0x6d00: \"Instruction not supported\",\n  0x6e00: \"App does not seem to be open\",\n  0x6f00: \"Unknown error\",\n  0x6f01: \"Sign/verify error\"\n};\n\nfunction errorCodeToString(statusCode) {\n  if (statusCode in ERROR_DESCRIPTION) return ERROR_DESCRIPTION[statusCode];\n  return \"Unknown Status Code: \".concat(statusCode);\n}\n\nfunction isDict(v) {\n  return (0, _typeof2.default)(v) === \"object\" && v !== null && !(v instanceof Array) && !(v instanceof Date);\n}\n\nfunction processErrorResponse(response) {\n  if (response) {\n    if (isDict(response)) {\n      if (Object.prototype.hasOwnProperty.call(response, \"statusCode\")) {\n        return {\n          return_code: response.statusCode,\n          error_message: errorCodeToString(response.statusCode)\n        };\n      }\n\n      if (Object.prototype.hasOwnProperty.call(response, \"return_code\") && Object.prototype.hasOwnProperty.call(response, \"error_message\")) {\n        return response;\n      }\n    }\n\n    return {\n      return_code: 0xffff,\n      error_message: response.toString()\n    };\n  }\n\n  return {\n    return_code: 0xffff,\n    error_message: response.toString()\n  };\n}\n\nfunction getVersion(_x, _x2) {\n  return _getVersion.apply(this, arguments);\n}\n\nfunction _getVersion() {\n  _getVersion = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(transport, cla) {\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", transport.send(cla, INS.GET_VERSION, 0, 0).then(function (response) {\n              var errorCodeData = response.slice(-2);\n              var returnCode = errorCodeData[0] * 256 + errorCodeData[1]; // 12 bytes + 2 error code\n\n              if (response.length !== 14) {\n                return {\n                  return_code: 0x6984,\n                  error_message: errorCodeToString(0x6984)\n                };\n              }\n\n              var major = response[1] * 256 + response[2];\n              var minor = response[3] * 256 + response[4];\n              var patch = response[5] * 256 + response[6];\n              var deviceLocked = response[7] === 1; // eslint-disable-next-line no-bitwise\n\n              var targetId = (response[8] << 24) + (response[9] << 16) + (response[10] << 8) + (response[11] << 0);\n              return {\n                return_code: returnCode,\n                error_message: errorCodeToString(returnCode),\n                // ///\n                test_mode: response[0] !== 0,\n                major: major,\n                minor: minor,\n                patch: patch,\n                deviceLocked: deviceLocked,\n                target_id: targetId.toString(16)\n              };\n            }, processErrorResponse));\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getVersion.apply(this, arguments);\n}\n\nmodule.exports = {\n  CHUNK_SIZE: CHUNK_SIZE,\n  INS: INS,\n  PAYLOAD_TYPE: PAYLOAD_TYPE,\n  P1_VALUES: P1_VALUES,\n  SCHEME: SCHEME,\n  ERROR_CODE: ERROR_CODE,\n  getVersion: getVersion,\n  processErrorResponse: processErrorResponse,\n  errorCodeToString: errorCodeToString\n};"]},"metadata":{},"sourceType":"script"}