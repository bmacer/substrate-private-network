{"ast":null,"code":"// Copyright 2017-2021 @polkadot/util authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport BN from 'bn.js';\nimport { assert } from \"../assert.mjs\";\nimport { BN_MAX_INTEGER, BN_ONE, BN_ZERO } from \"./index.mjs\";\nimport { bnToBn } from \"./toBn.mjs\";\n/**\n * @name bnSqrt\n * @summary Calculates the integer square root of a BN\n * @example\n * <BR>\n *\n * ```javascript\n * import BN from 'bn.js';\n * import { bnSqrt } from '@polkadot/util';\n *\n * bnSqrt(new BN(16)).toString(); // => '4'\n * ```\n */\n\nexport function bnSqrt(value) {\n  const n = bnToBn(value);\n  assert(n.gte(BN_ZERO), 'square root of negative numbers is not supported'); // https://stackoverflow.com/questions/53683995/javascript-big-integer-square-root/\n  // shortcut <= 2^53 - 1 to use the JS utils\n\n  if (n.lte(BN_MAX_INTEGER)) {\n    return new BN(Math.floor(Math.sqrt(n.toNumber())));\n  } // Use sqrt(MAX_SAFE_INTEGER) as starting point. since we already know the\n  // output will be larger than this, we expect this to be a safe start\n\n\n  let x0 = new BN(94906265);\n\n  while (true) {\n    const x1 = n.div(x0).iadd(x0).ishrn(1);\n\n    if (x0.eq(x1) || x0.eq(x1.sub(BN_ONE))) {\n      return x0;\n    }\n\n    x0 = x1;\n  }\n}","map":{"version":3,"sources":["/Users/bmacer/substrate-node-template/substrate-front-end-template/node_modules/@polkadot/util/bn/sqrt.mjs"],"names":["BN","assert","BN_MAX_INTEGER","BN_ONE","BN_ZERO","bnToBn","bnSqrt","value","n","gte","lte","Math","floor","sqrt","toNumber","x0","x1","div","iadd","ishrn","eq","sub"],"mappings":"AAAA;AACA;AACA,OAAOA,EAAP,MAAe,OAAf;AACA,SAASC,MAAT,QAAuB,eAAvB;AACA,SAASC,cAAT,EAAyBC,MAAzB,EAAiCC,OAAjC,QAAgD,aAAhD;AACA,SAASC,MAAT,QAAuB,YAAvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,SAASC,MAAT,CAAgBC,KAAhB,EAAuB;AAC5B,QAAMC,CAAC,GAAGH,MAAM,CAACE,KAAD,CAAhB;AACAN,EAAAA,MAAM,CAACO,CAAC,CAACC,GAAF,CAAML,OAAN,CAAD,EAAiB,kDAAjB,CAAN,CAF4B,CAEgD;AAC5E;;AAEA,MAAII,CAAC,CAACE,GAAF,CAAMR,cAAN,CAAJ,EAA2B;AACzB,WAAO,IAAIF,EAAJ,CAAOW,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,IAAL,CAAUL,CAAC,CAACM,QAAF,EAAV,CAAX,CAAP,CAAP;AACD,GAP2B,CAO1B;AACF;;;AAGA,MAAIC,EAAE,GAAG,IAAIf,EAAJ,CAAO,QAAP,CAAT;;AAEA,SAAO,IAAP,EAAa;AACX,UAAMgB,EAAE,GAAGR,CAAC,CAACS,GAAF,CAAMF,EAAN,EAAUG,IAAV,CAAeH,EAAf,EAAmBI,KAAnB,CAAyB,CAAzB,CAAX;;AAEA,QAAIJ,EAAE,CAACK,EAAH,CAAMJ,EAAN,KAAaD,EAAE,CAACK,EAAH,CAAMJ,EAAE,CAACK,GAAH,CAAOlB,MAAP,CAAN,CAAjB,EAAwC;AACtC,aAAOY,EAAP;AACD;;AAEDA,IAAAA,EAAE,GAAGC,EAAL;AACD;AACF","sourcesContent":["// Copyright 2017-2021 @polkadot/util authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport BN from 'bn.js';\nimport { assert } from \"../assert.mjs\";\nimport { BN_MAX_INTEGER, BN_ONE, BN_ZERO } from \"./index.mjs\";\nimport { bnToBn } from \"./toBn.mjs\";\n/**\n * @name bnSqrt\n * @summary Calculates the integer square root of a BN\n * @example\n * <BR>\n *\n * ```javascript\n * import BN from 'bn.js';\n * import { bnSqrt } from '@polkadot/util';\n *\n * bnSqrt(new BN(16)).toString(); // => '4'\n * ```\n */\n\nexport function bnSqrt(value) {\n  const n = bnToBn(value);\n  assert(n.gte(BN_ZERO), 'square root of negative numbers is not supported'); // https://stackoverflow.com/questions/53683995/javascript-big-integer-square-root/\n  // shortcut <= 2^53 - 1 to use the JS utils\n\n  if (n.lte(BN_MAX_INTEGER)) {\n    return new BN(Math.floor(Math.sqrt(n.toNumber())));\n  } // Use sqrt(MAX_SAFE_INTEGER) as starting point. since we already know the\n  // output will be larger than this, we expect this to be a safe start\n\n\n  let x0 = new BN(94906265);\n\n  while (true) {\n    const x1 = n.div(x0).iadd(x0).ishrn(1);\n\n    if (x0.eq(x1) || x0.eq(x1.sub(BN_ONE))) {\n      return x0;\n    }\n\n    x0 = x1;\n  }\n}"]},"metadata":{},"sourceType":"module"}